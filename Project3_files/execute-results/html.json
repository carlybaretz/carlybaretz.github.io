{
  "hash": "e45616c8eb0a02e6500caf8dab14ccf0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Project 3\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.3     ✔ tidyr     1.3.1\n✔ purrr     1.0.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors\n```\n\n\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(openintro)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nLoading required package: airports\nLoading required package: cherryblossom\nLoading required package: usdata\n```\n\n\n:::\n\n```{.r .cell-code}\ndata(\"mlb\")\n```\n:::\n\n\nResearch Question: Do pitchers on the Mets or pitchers on the Yankees make more money?\n\nUsing the MLB dataset, which shows the salary of every player on a Major League Baseball team in 2010, I plan first selecting all the pitchers on the Mets, and then all the pitchers on the Yankees. After, I plan on finding the average salary and the difference in salaries between the two teams. After I will do a permutation test and plot the permutation distribution and observed difference.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmlb_pitchers <- mlb |>\n  filter(team %in% c(\"New York Mets\", \"New York Yankees\") & position == \"Pitcher\") |>\n  select(team, salary) |>\n  drop_na()\n\nmlb_pitchers\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 24 × 2\n   team          salary\n   <fct>          <dbl>\n 1 New York Mets 20145.\n 2 New York Mets 12167.\n 3 New York Mets 12000 \n 4 New York Mets  3300 \n 5 New York Mets  2900 \n 6 New York Mets  1250 \n 7 New York Mets  1250 \n 8 New York Mets  1000 \n 9 New York Mets   975 \n10 New York Mets   500 \n# ℹ 14 more rows\n```\n\n\n:::\n:::\n\n\nThe table above shows just the salaries of pitchers on the Mets and pitchers on the Yankees.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Calculate the observed difference in average salary between Mets and Yankees\nobs_diff <- mlb_pitchers |>\n  group_by(team) |>\n  reframe(obs_ave = mean(salary)) |>\n  reframe(obs_ave_diff = diff(obs_ave)) |>\n  pull(obs_ave_diff)\n\n# Check if obs_diff was calculated correctly\nprint(obs_diff)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2548.385\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define the permutation function to calculate permuted differences in average salary\nperm_data <- function(rep, data) {\n  data |>\n    mutate(salary_perm = sample(salary, replace = FALSE)) |>\n    group_by(team) |>\n    reframe(perm_ave = mean(salary_perm)) |>\n    reframe(perm_ave_diff = diff(perm_ave), rep = rep)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(47)\n\nperm_stats <- map(1:500, perm_data, data = mlb_pitchers) |>\n  list_rbind()\n\nperm_stats\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 500 × 2\n   perm_ave_diff   rep\n           <dbl> <int>\n 1        -2410.     1\n 2        -3256.     2\n 3          869.     3\n 4        -2796.     4\n 5        -5145.     5\n 6         5764.     6\n 7        -1841.     7\n 8        -3057.     8\n 9          428.     9\n10        -3170.    10\n# ℹ 490 more rows\n```\n\n\n:::\n:::\n\n\nThis table, perm_stats, displays the results of 500 permutations of the salary data between Mets and Yankees pitchers, showing the calculated differences in average salary (perm_ave_diff) for each permutation. Each row represents a single permutation, providing a simulated difference under the null hypothesis to help assess the significance of the observed salary difference.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(summary(perm_stats$perm_ave_diff))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-7548.23 -2193.39   -73.50   -50.74  1995.02  9158.57 \n```\n\n\n:::\n\n```{.r .cell-code}\np_value <- mean(perm_stats$perm_ave_diff > obs_diff)\n\np_value\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.198\n```\n\n\n:::\n\n```{.r .cell-code}\ncat(\"P-value for the observed average difference:\", p_value, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nP-value for the observed average difference: 0.198 \n```\n\n\n:::\n\n```{.r .cell-code}\nperm_stats |>\n  ggplot(aes(x = perm_ave_diff)) + \n  geom_histogram(bins = 50, fill = \"lightblue\", color = \"black\") + \n  geom_vline(xintercept = obs_diff, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"Permutation Test: Difference in Mean Salary (Mets vs. Yankees Pitchers)\",\n       x = \"Difference in Permuted Mean Salary\", y = \"Frequency\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](Project3_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThis histogram provides descriptive statistics for the distribution of permuted mean salary differences between Mets and Yankees pitchers, showing the range and central tendency of values generated under the null hypothesis. The p-value indicates the proportion of permuted differences that exceed the observed difference, and the histogram visualizes this distribution, with a red line marking the observed difference for comparison.\n\nIn this analysis, I conducted a permutation test to determine if there is a significant difference in average salary between pitchers on the Mets and Yankees using the mlb dataset from the openintro package. First, I calculated the observed difference in average salary of pitchers between the two teams. Then, I defined a permutation function that randomly shuffles the salaries across teams to simulate the null hypothesis, calculating the difference in mean salary for each permutation. Finally, I repeated this process 500 times to build a distribution of permuted differences, compared the observed difference to this distribution, and computed a p-value to assess significance, visualizing the results in a histogram.\n\nPitchers on the Mets have a higher average salary than pitchers on the Yankees by about \\$2,548,385.\n\nHowever, the p-value of 0.198 from the permutation test suggests that this difference isn't statistically significant. In other words, the observed difference could reasonably occur by chance in about 20% of random permutations. So, while the Mets pitchers have a slightly higher average salary in this dataset, we don't have strong evidence to conclude that this difference is meaningful or consistent.\n\n\\*In the dataset, salaries are represented in thousands. For example, a value of 400 corresponds to a salary of \\$400,000, and a value of 20144 represents \\$20,144,000.\n\nThis dataset came from the openintro package, mlb. \"Salary data for Major League Baseball (2010)\" https://openintrostat.github.io/openintro/reference/mlb.html\n",
    "supporting": [
      "Project3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}